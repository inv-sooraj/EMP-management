<div class="container mt-3">
    <div class="col">
        <div class="row">
            <div class="col-4" *ngFor=" let sta of roleStatusCount|keyvalue">
                <div class="card">
                    <div class="card-statistic-3">
                        <div class="m-4">
                            <h5 class="card-title mb-0">{{sta.key}}</h5>
                        </div>
                        <div class="row align-items-center mb-2 d-flex">
                            <div class="col-8 px-4 pb-1">
                                <h2 class="d-flex align-items-center mb-0">
                                    {{sta.value}}
                                </h2>
                            </div>

                        </div>

                    </div>
                </div>
            </div>

        </div>
    </div>


</div>











<div class="container">



    <div class="table-wrapper">
        <div class="table-title">
            <div class="row">
                <div class="col-sm-6">
                    <h2>Manage <strong>users</strong></h2>
                </div>
                <div class="col-sm-6">
                    <button routerLink="/user-form" class="btn btn-success">
                        <em class="bi bi-plus-circle-fill"></em>

                        &nbsp; Add user
                    </button>&nbsp;

                    <button (click)="deleteUsers()" class="btn btn-danger">
                        <em class="bi-trash-fill"></em>
                        &nbsp;Delete Users
                    </button>

                    <button (click)="downloadCsv()" class="btn btn-danger">
                        <em class="bi bi-download"></em>
                        &nbsp;Download
                    </button>
                </div>
            </div>
        </div>

        <div class="row">

            <div class="col-6">
                Show
                <select class="form-select w-auto d-inline" [(ngModel)]="limit" (change)="setLimit()">
                    <option selected="selected" [ngValue]="3">3</option>
                    <option [ngValue]="4">4</option>
                    <option [ngValue]="5">5</option>
                </select>
                entries
            </div>


            <div class="col-6 text-end">
                <input placeholder="search" class="form-control w-auto d-inline align-self-end" type="text" id="search"
                    [(ngModel)]="search" (keyup)="setSearch()" />
            </div>

        </div>


        <table class="table table-striped table-hover">
            <thead>
                <tr>
                    <th scope="col">
                        <span class="custom-checkbox">
                            <input type="checkbox" id="selectAll" (change)="checkAll($event)" />
                            <label for="selectAll"></label>
                        </span>
                    </th>


                    <th scope="col" (click)="setSort('user_id')">Id<span
                            class="glyphicon glyphicon-triangle-bottom"></span></th>
                    <th scope="col" (click)="setSort('name')">Name<span
                            class="glyphicon glyphicon-triangle-bottom"></span></th>
                    <th scope="col" (click)="setSort('userName')">User Name<span
                            class="glyphicon glyphicon-triangle-bottom"></span></th>
                    <th scope="col" (click)="setSort('email')">Email<span
                            class="glyphicon glyphicon-triangle-bottom"></span></th>
                    <th scope="col" (click)="setSort('update_date')">Last Update<span
                            class="glyphicon glyphicon-triangle-bottom"></span></th>
                    <th scope="col" (click)="setSort('status')">Status<span
                            class="glyphicon glyphicon-triangle-bottom"></span></th>

                    <th scope="col" (click)="setSort('role')">Role<span
                            class="glyphicon glyphicon-triangle-bottom"></span></th>
                    <th scope="col">Actions</th>


                </tr>
            </thead>

            <tbody *ngIf="userList.result">
                <tr *ngIf="userList.result.length == 0">
                    <th class="text-center" id="NoRecordsFound" colspan="10">
                        No Records Found
                    </th>
                </tr>
                <tr *ngFor="let user of userList.result">
                    <td>
                        <span class="custom-checkbox">
                            <input type="checkbox" id="checkbox{{ user.userId }}" value="{{ user.userId }}"
                                (change)="checkedUser($event)" />
                            <label for="checkbox{{ user.userId }}"></label>
                        </span>
                    </td>
                    <td>{{ user.userId }}</td>
                    <td>{{ user.name }}</td>
                    <td>{{ user.userName }}</td>
                    <td>{{ user.email }}</td>
                    <td>{{ user.updateDate }}</td>
                    <td>{{ status[user.status] }}</td>
                    <td>{{ roles[user.role] }}</td>

                    <!-- <td>
                        <a class="edit" data-toggle="modal" routerLink="/user-form/{{ user.userId }}"><em
                                class="material-icons" data-toggle="tooltip" title="Edit">&#xE254;</em></a>
                        <a class="delete" data-toggle="modal" (click)="deleteUser(user.userId)">
                            <em class="material-icons" data-toggle="tooltip" title="Delete">&#xE872;</em>
                        </a>
                    </td> -->

                    <td *ngIf="role==2">
                        <button placement="top" ngbTooltip="Edit user" class="btn"><a
                                (click)="open(userEditModal);userId=user.userId"
                                class="bi bi-pencil-fill edit"></a></button>
                        &nbsp;
                        <button placement="top" ngbTooltip="Delete User" class="btn" (click)="deleteUser(user.userId)">
                            <a class="bi bi-trash-fill delete"></a>
                        </button>

                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <div class="clearfix" *ngIf="userList">
        <div class="hint-text">
            Showing
            <strong>{{ userList.itemStart }} </strong> to <strong> {{ userList.itemEnd }} </strong> out of
            <strong>{{ userList.numItems }}</strong> entries
        </div>

        <div>
            <ul class="pagination">
                <li class="page-item" [class.disabled]="!userList.hasPrevious">
                    <button class="page-link" (click)="prevPage()">Previous</button>
                </li>

                <li class="page-item" *ngFor="let s of numSeq(userList.numPages); let i = index"
                    [ngClass]="{ active: userList.currentPage == i + 1 }">
                    <button (click)="gotoPage(i + 1)" class="page-link">
                        {{ i + 1 }}
                    </button>
                </li>

                <li class="page-item" [class.disabled]="!userList.hasNext">
                    <button class="page-link" (click)="nextPage()">Next</button>
                </li>
            </ul>
        </div>
    </div>
</div>



<ng-template #userEditModal let-modal>
    <div class="modal-header">
        <h4 class="modal-title" id="modal-basic-title">Edit User Details</h4>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
    </div>
    <div class="modal-body">

        <app-admin-user-edit (completedEvent)="listUsers()" #adminUserEditComponent [userId]="userId">
        </app-admin-user-edit>

    </div>
    <div class="modal-footer">
        <button class="btn btn-outline-success" (click)="adminUserEditComponent.update();modal.dismiss('Save')"> Save
        </button>

    </div>
</ng-template>