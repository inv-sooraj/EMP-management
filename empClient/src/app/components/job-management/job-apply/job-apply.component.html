
<div class="container">
    <div class="table-responsive">

        <div class="table-wrapper">
            <div class="table-title">
                <div class="row">
                    <div class="col-sm-6">
                        <h2>Manage <strong>Jobs</strong></h2>
                    </div>
                </div>
            </div>


            <div class="row">

                <div class="col-2">
                    Show
                    <div ngbDropdown #limitDropDown="ngbDropdown" class="d-inline-block">
                        <button type="button" class="btn btn-outline-secondary" id="dropdownBasic1" ngbDropdownToggle>
                            {{ limit?limit:"All"}}
                        </button>
                        <div ngbDropdownMenu aria-labelledby="dropdownBasic1 m-auto">
                            <button ngbDropdownItem (click)="limit=0;resetList()">All</button>
                            <button ngbDropdownItem (click)="limit=4;resetList()">4</button>
                            <button ngbDropdownItem (click)="limit=5;resetList()">5</button>
                            <hr>

                            <div class="d-flex">

                                <label class="mx-3 d-block">
                                    Enter Limit
                                </label>
                                <input (change)="resetList()" class="form-control-plaintext mx-3 my-0 d-inline d-block"
                                    style="width: 50px;" type="number" [(ngModel)]="limit" uplaceholder="Enter Limit"
                                    id="limitfield">
                            </div>
                        </div>
                    </div>
                    entries
                </div>

                <div class="col-6 text-end">
                    <input placeholder="search" class="form-control w-auto d-inline align-self-end" type="text"
                        id="search" [(ngModel)]="search" (keyup)="resetList()" />
                </div>

            </div>

            <table class="table table-striped table-hover">
                <thead>
                    <tr>
                        
                        <th scope="col" (click)="setSort('title')">Title
                            <button [disabled]="sortBy!='title'" class="btn btn-sort bi "
                                [ngClass]="sortDesc ? 'bi-sort-alpha-up':'bi-sort-alpha-down'"></button>
                        </th>
                        <th scope="col" (click)="setSort('description')">Description
                            <button [disabled]="sortBy!='description'" class="btn btn-sort bi "
                                [ngClass]="sortDesc ? 'bi-sort-alpha-up':'bi-sort-alpha-down'"></button>

                        </th>
                        <th scope="col" (click)="setSort('qualification')">Qualification
                            <button [disabled]="sortBy!='qualification'" class="btn btn-sort bi "
                                [ngClass]="sortDesc ? 'bi-sort-numeric-up':'bi-sort-numeric-down'"></button>
                        </th>


                        <th scope="col" (click)="setSort('openings')">Openings
                            <button [disabled]="sortBy!='openings'" class="btn btn-sort bi "
                                [ngClass]="sortDesc ? 'bi-sort-numeric-up':'bi-sort-numeric-down'"></button>

                        </th>
                        <th scope="col">Employer</th>
                        <th scope="col">User</th>
                        <th scope="col" (click)="setSort('status')">Status</th>
                    </tr>
                </thead>

                <tbody *ngIf="jobDataList">
                    <tr *ngIf="jobDataList.length == 0">
                        <th class="text-center" id="NoRecordsFound" colspan="10">
                            No Records Found
                        </th>
                    </tr>
                    <tr *ngFor="let job of jobDataList">

                        
                        <td>{{ job.title }}</td>
                        <td style="overflow-wrap: break-word; max-width: 200px;">{{ job.description }}</td>
                        <td>{{ qualifications.get(job.qualification) }}</td>
                        <td>{{ job.openings }}</td>
                        <td>{{ job.userId }}</td>
                        <td>{{ job.updateDate|date }}</td>

                        <td>
                            <button *ngIf="!job.eligible" disabled class="btn btn-outline-dark">Not Eligible</button>

                            <button *ngIf="!appliedJobs.includes(job.jobId) && job.eligible"
                                (click)="applyJob(job.jobId)" class="btn btn-outline-dark" placement="top"
                                ngbTooltip='Apply for job "{{job.title}}"'>Apply</button>

                            <button *ngIf="appliedJobs.includes(job.jobId)" disabled
                                class="btn btn-outline-dark">Applied</button>
                            &nbsp;

                        </td>
                    </tr>
                    <tr *ngIf="pagerInfo && !pagerInfo.hasNext && jobDataList.length != 0">
                        <th class="text-center" id="NoRecordsFound" colspan="10">
                            End of Records
                        </th>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="clearfix" *ngIf="pagerInfo && limit">
        <div class="hint-text text-white">
            Showing &nbsp;
            <strong>{{ pagerInfo.itemStart }} </strong> to <strong> {{ pagerInfo.itemEnd }} </strong> out of
            <strong>{{ pagerInfo.count }}</strong> &nbsp; entries
        </div>

        <div>
            <ul class="pagination mb-5">

                <li class="page-item">

                    <label class=" text-white me-2 d-inline" style="font-size: 15px;"> Go to page</label>
                    <input class="page-link me-3 d-inline" style="width: 60px;" type="number" (change)="setPage($event)"
                        min="1" [max]="pagerInfo.numPages">
                </li>

                <li class="page-item" [class.disabled]="!pagerInfo.hasPrev">
                    <button class="page-link" (click)="gotoPage(1)">
                        First
                    </button>
                </li>
                <li class="page-item" [class.disabled]="!pagerInfo.hasPrev">
                    <button class="page-link" (click)="prevPage()"><em class="bi bi-caret-left-fill"></em></button>
                </li>

                <li class="page-item" *ngIf="pagerInfo.currentPage  > 3 && pagerInfo.numPages>5">
                    <button class="page-link" disabled>
                        ..
                    </button>
                </li>

                <li class="page-item" *ngFor="let s of numSeq(pagerInfo.numPages);"
                    [ngClass]="{ active: pagerInfo.currentPage == s }">
                    <button (click)="gotoPage(s)" class="page-link">
                        {{ s }}
                    </button>
                </li>

                <li class="page-item" *ngIf="pagerInfo.currentPage < pagerInfo.numPages - 2 && pagerInfo.numPages>5">
                    <button class="page-link" disabled>
                        ..
                    </button>
                </li>



                <li class="page-item" [class.disabled]="!pagerInfo.hasNext">
                    <button class="page-link" (click)="nextPage()"><em class="bi bi-caret-right-fill"></em></button>
                </li>

                <li class="page-item" [class.disabled]="!pagerInfo.hasNext">
                    <button class="page-link" (click)="gotoPage(pagerInfo.numPages)">
                       Last
                    </button>
                </li>
            </ul>
        </div>
    </div>
</div>

<div class="search-results" infinite-scroll [infiniteScrollDistance]="scrollDistance"
    [infiniteScrollUpDistance]="scrollUpDistance" [infiniteScrollThrottle]="throttle" (scrolled)="onScrollDown()">

</div>